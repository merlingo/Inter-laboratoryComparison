@model CalCom.Web.Models.AdminPanel.KarBaslatViewModel
@{
    ViewBag.Title = "LabTestAnalizi";
    Layout = "~/Views/Shared/_admin_layout.cshtml";
}
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    

      <!-- Content Wrapper. Contains page content -->
        <section class="content-header">
          <h1>
         Karşılaştırma Başlatma
          </h1>
          <ol class="breadcrumb">
           <li><i class="fa fa-dashboard"></i> <a href="Baslangic">Süreç-Başlangıç</a></li>
            <li  class="active"><i></i> Karşılaştırma Başlat</li>
          </ol>
        </section>

        <!-- Main content -->
        <section class="content">
        
        @using (Html.BeginForm("BaslatilacakKarsilastirmalar", "AdminPanel", FormMethod.Get))
{
                     <div class="box">
                           <div class="box-header with-border">
              <h3 class="box-title">Karşılaştırmalar</h3>
            @*  <div class="box-tools pull-right">
                  <button class="btn btn-box-tool dropdown-toggle" data-toggle="modal" data-target="#labtestsecim" style="cursor:pointer"><i class="fa fa-wrench"></i></button>
          </div>*@
            </div>
           
          <div class="box-body table-responsive no-padding">
              
                        <p>Burada tablo olur, tabloda test durumu arşiv olan ya da testi başlatılmamış tüm karşılaştırmalar listelenir. Laboratuvar çoklu seçim yapar seçim kadar bas bekleyen test veritabanına eklenir.
                         her test için test bilgileri alınacaktır. Verigirişi yapılan test kaydete basınca divi gizlenir, bir sonraki açılır. Kenarda bulunan linkler </p> 
                     <table class="table table-hover">
                        <tbody>
                           <thead>
                        <tr>
                            <th>Ölçüm Aleti
                            </th>
                            <th>Seri No
                            </th>
                            <th>Model
                            </th>
                            <th>Çözünürlük
                            </th>
                            <th>Kapasite
                            </th>
                            <th>Ölçüm Aralığı Baş. Değ.
                            </th>
                            <th>Ölçüm Aralığı Bit. Değ.
                            </th>
                            <th>Tür
                            </th>
                            <th>Test Sayısı
                            </th>
                            <th>Seç
                            </th>
                        </tr>
                    </thead>

                           
                               @for (int i = 0; i < Model.karbaslist.Count; i++)
                        {
                            <tr>
                                <td>@Html.DisplayFor(mz => mz.karbaslist[i].OA.Isim) @Html.Hidden( "btl.karbaslist["+i+"].id",Model.karbaslist[i].id) </td>
                                <td>@Html.DisplayFor(mz => mz.karbaslist[i].OA.SeriNo)</td>
                                <td>@Html.DisplayFor(mz => mz.karbaslist[i].OA.Model)</td>
                                <td>@Html.DisplayFor(mz => mz.karbaslist[i].OA.Cozunurluk)</td>
                                <td>@Html.DisplayFor(mz => mz.karbaslist[i].OA.Kapasite)</td>
                                <td>@Html.DisplayFor(mz => mz.karbaslist[i].olcumAraligi[0])</td>
                                <td>@Html.DisplayFor(mz => mz.karbaslist[i].olcumAraligi[1])</td>
                                <td>@Html.DisplayFor(mz => mz.karbaslist[i].Tür)</td>
                                <td>@Html.DisplayFor(mz => mz.karbaslist[i].kacDefa)</td>
                                <td>@Html.CheckBox("btl.karbaslist["+i+"].secildiMi")</td>
                            </tr>
                        }
                         </table>
                     </div>
              </div>                           
            <input type="submit" value="ONAYLA" title="SEÇ" />
} 
   
    </section><!-- /.content -->
    </div>

        
          <aside class="control-sidebar control-sidebar-dark">
        <!-- Create the tabs -->
      @*  <ul class="nav nav-tabs nav-justified control-sidebar-tabs">
          <li class="active"><a href="#control-sidebar-home-tab" data-toggle="tab"><i class="fa fa-eye"></i></a></li>
          <li><a href="#control-sidebar-settings-tab" data-toggle="tab"><i class="fa  fa-exchange"></i></a></li>
        </ul>
        <!-- Tab panes -->*@
        <div class="tab-content">
          <!-- Home tab content -->
          <div class="tab-pane active" id="control-sidebar-home-tab">
            <h3 class="control-sidebar-heading">İzlence</h3>
            <ul class="control-sidebar-menu">
             
              <li>
                <a href="TestTakip">
                  <i class="menu-icon fa fa-line-chart bg-yellow"></i>
                  <div class="menu-info">
                    <h4 class="control-sidebar-subheading">Test Takip</h4>
                    <p>Başlatılan karşılaştırmaların takibi</p>
                  </div>
                </a>
              </li>
              <li>
              <li>
                <a href="Takvimlendirme">
                  <i class="menu-icon fa fa-flask bg-light-blue"></i>
                  <div class="menu-info">
                    <h4 class="control-sidebar-subheading">Takvimlendirme</h4>
                    <p>Labların kalibrasyon tarihlerini belirleme</p>
                  </div>
                </a>
              </li>
              <li>
                <a href="LabTestAnalizi">
                  <i class="menu-icon fa fa-balance-scale bg-red"></i>
                  <div class="menu-info">
                    <h4 class="control-sidebar-subheading">Lab - Test Analizi</h4>
                    <p>Karşılaştırmaya kayıt olan Laboratuvarlar</p>
                  </div>
                </a>
              </li>
                </ul>
               <h3 class="control-sidebar-heading">İşlemler</h3>
               <ul class="control-sidebar-menu">
                   
               <li>
                <a href="KarsilastirmaBaslat">
                  <i class="menu-icon fa fa-balance-scale bg-red"></i>
                  <div class="menu-info">
                    <h4 class="control-sidebar-subheading">Karşılaştırma Başlat</h4>
                    <p>Yeni karşılaştırma başlatma ve yayınlama</p>
                  </div>
                </a>
                </li>
                 <li>
                <a  data-toggle="modal" data-target="#labtestsecim" onclick="IslemPartial('ProtokolEkle')">
                  <i class="menu-icon fa fa-flask bg-light-blue"></i>
                  <div class="menu-info">
                    <h4 class="control-sidebar-subheading">Protokol Ekle</h4>
                    <p>Labların kalibrasyon tarihlerini belirleme</p>
                  </div>
                </a>
              </li>
                 <li>
                <a data-toggle="modal" data-target="#labtestsecim" href="#" onclick="IslemPartial('DavetAyarlari')">
                  <i class="menu-icon fa fa-line-chart bg-yellow"></i>
                  <div class="menu-info">
                    <h4 class="control-sidebar-subheading">Karşılaştırma Daveti</h4>
                    <p>Başlatılan karşılaştırmalar için lablara  atılan mail için mail ayarları</p>
                  </div>
                </a>
              </li>
            </ul><!-- /.control-sidebar-menu -->


          </div>
        </div>
      </aside><!-- /.control-sidebar -->
      <div class="control-sidebar-bg"></div>
<div id="labtestsecim" class="modal fade" role="dialog">

  <div class="modal-dialog" >   
    <div class="modal-content" >
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h3>Lab ve Test Seçimi</h3>
       </div>
         <div class="modal-body">
   <!-- Modal content-->
                 <div class="overlay">
                  <i class="fa fa-refresh fa-spin"></i>
                </div> 
         </div>
         <div class="modal-footer">
                    <button type="button" class="btn btn-default pull-left" data-dismiss="modal">Close</button>
                   <button type="submit" class="btn btn-success">Kaydet</button>
                  </div>
     </div>
  </div>
</div>
<script>
    var sekme = document.getElementById("baslangic_sekme");
    sekme.classList.add("active");
    var i=0;
    //FİKİR: lab listesi ve test listesi ayrı olur herbirinin idsi ve ismi olacak sekilde... bunların çarpımı olacak şekilde bir tablo oluşturulur. Sonra id lerin yardımıyla ölçüm verileri tabloyu doldurur. tablonun üstündeki ayar düğmesi de kaça kaçlık matrix ve bulunacak elemanları seçmekte kullanılır modal ile

    function IslemPartial(is) {
        $.ajax(
       {
           url: '/AdminPanel/' + is,
           type: "GET",
           //data: { 'id': id, 'k': k },
           success: function (response) {
               $("#labtestsecim").html(response);
           }
       });
    }
    
</script>

